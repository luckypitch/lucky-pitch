<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elemzés | LuckyPitch</title>
    <style>
        :root { --primary: #00ff88; --text: #fff; --bg: #0d0d0d; --box: rgba(255,255,255,0.07); }
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Inter', sans-serif; }
        body { background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: var(--box); padding: 30px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); }
        h2 { color: var(--primary); margin-bottom: 20px; text-align: center; }
        .stat-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .ai-box { background: rgba(0, 255, 136, 0.1); border: 1px solid var(--primary); padding: 20px; border-radius: 12px; margin-top: 20px; }
        .back-btn { display: inline-block; margin-bottom: 20px; color: var(--text); text-decoration: none; font-size: 14px; opacity: 0.7; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/meccsek" class="back-btn">← Vissza a meccsekhez</a>
        <div id="loading">Elemzés készítése...</div>
        <div id="content" style="display: none;">
            <h2 id="match-title">Betöltés...</h2>
            <div id="stats"></div>
            <div class="ai-box">
                <h4 style="color: var(--primary); margin-bottom: 10px;">LuckyPitch AI Tipp:</h4>
                <p id="ai-prediction">Számítás folyamatban...</p>
            </div>
        </div>
    </div>

    <script>
        async function loadAnalysis() {
            const urlParams = new URLSearchParams(window.location.search);
            const matchId = urlParams.get('id');

            if (!matchId) {
                document.getElementById("loading").innerText = "Hiba: Nincs meccs azonosító!";
                return;
            }

            try {
                const res = await fetch(`/match-details/${matchId}`);
                const data = await res.json();

                document.getElementById("loading").style.display = "none";
                document.getElementById("content").style.display = "block";

                document.getElementById("match-title").innerText = `${data.homeTeam.name} vs ${data.awayTeam.name}`;
                
                const stats = [
                    { label: "Bajnokság", val: data.competition.name },
                    { label: "Állás", val: `${data.score.fullTime.home ?? 0} - ${data.score.fullTime.away ?? 0}` },
                    { label: "Státusz", val: data.status === "IN_PLAY" ? "Élő" : "Befejezett" }
                ];

                document.getElementById("stats").innerHTML = stats.map(s => `
                    <div class="stat-row">
                        <span>${s.label}</span>
                        <span style="font-weight:bold">${s.val}</span>
                    </div>
                `).join('');

                // Egyszerű AI szimuláció a meglévő adatok alapján
                const homeProb = 45 + (data.score.fullTime.home * 5);
                document.getElementById("ai-prediction").innerText = 
                    `Az adatok alapján a(z) ${data.homeTeam.name} győzelmi esélye jelenleg kb. ${homeProb}%. A mérkőzés hátralévő részében ${data.score.fullTime.home + data.score.fullTime.away > 2 ? 'kevesebb' : 'több'} gól várható.`;

            } catch (e) {
                document.getElementById("loading").innerText = "Hiba az adatok betöltésekor.";
            }
        }

        loadAnalysis();
    </script>
</body>
</html>
