<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LuckyPitch | Elemzés</title>
    <script async crossorigin="anonymous" data-clerk-publishable-key="pk_test_YWxsb3dlZC1pbnNlY3QtOTguY2xlcmsuYWNjb3VudHMuZGV2JA" src="https://allowed-insect-98.clerk.accounts.dev/npm/@clerk/clerk-js@latest/dist/clerk.browser.js" type="text/javascript"></script>
    <style>
        :root { --bg: #0a0f1e; --card: #162033; --primary: #00ff88; --text: #fff; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; }
        .container { max-width: 1000px; margin: 2rem auto; padding: 1rem; }
        .analysis-card { background: var(--card); border-radius: 15px; padding: 1.5rem; margin-bottom: 1.5rem; border-left: 5px solid var(--primary); }
        .prediction { font-size: 1.2rem; font-weight: bold; color: var(--primary); margin: 10px 0; }
        .confidence-bar { background: #334155; height: 10px; border-radius: 5px; margin-top: 5px; overflow: hidden; }
        .confidence-fill { background: var(--primary); height: 100%; transition: 1s; }
        .badge { background: #38bdf8; color: #000; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; }
    </style>
</head>
<body>

<nav style="padding: 1rem 5%; background: rgba(0,0,0,0.3);"><a href="/" style="color:var(--primary); font-weight:900; text-decoration:none;">LuckyPitch</a></nav>

<div class="container">
    <h2 style="margin-bottom:2rem;">Smart Analysis & Betting Tips</h2>
    <div id="analysis-list">Betöltés...</div>
</div>

<script>
    async function init() {
        await Clerk.load();
        if (!Clerk.user) { window.location.href = "/"; return; }
        loadData();
    }

    async function loadData() {
        const list = document.getElementById('analysis-list');
        try {
            const res = await fetch('/api/odds-data');
            const data = await res.json();
            if (!data || data.length === 0) { list.innerHTML = "Nincs elég adat az elemzéshez."; return; }

            list.innerHTML = data.map(m => {
                const conf = Math.floor(Math.random() * 25) + 65; // Szimulált algoritmus %
                return `
                    <div class="analysis-card">
                        <span class="badge">VALUE BET</span>
                        <h3 style="margin-top:10px;">${m.home_team} vs ${m.away_team}</h3>
                        <p style="opacity:0.7; font-size:0.9rem;">${m.sport_title}</p>
                        <div class="prediction">Tipp: ${m.home_team} győzelem vagy döntetlen</div>
                        <div style="font-size:0.8rem; margin-top:15px;">Bizalmi szint: ${conf}%</div>
                        <div class="confidence-bar"><div class="confidence-fill" style="width:${conf}%"></div></div>
                    </div>
                `;
            }).join('');
        } catch (e) { list.innerHTML = "Hiba az adatok lekérésekor."; }
    }
    window.onload = init;
</script>
</body>
</html>
